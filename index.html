<html>
  <head>
    <meta name="‚Äùrobots‚Äù" content="‚Äùnoindex‚Äù" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=yes"
    />

    <title>–ö–æ–ª–∞–±–æ—Ä–∞–Ω—Ç–∏</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6.0"></script>
    <!--     <script src="https://unpkg.com/axios/dist/axios.min.js"></script> -->
  </head>

  <body>
    
    
    <div style="font-family: arial; padding-bottom: 15px">
      –ù–∞ –≥—Ä–∞—Ñ—ñ–∫—É –ø–æ–∫–∞–∑–∞–Ω–æ —Å–µ—Ä–µ–¥–Ω—å–æ–º—ñ—Å—è—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ–ª–æ—Å—ñ–≤ –∑–∞ –∑–∞–∫–æ–Ω–æ–ø—Ä–æ—î–∫—Ç–∏ —É –¥—Ä—É–≥–æ–º—É —á–∏—Ç–∞–Ω–Ω—ñ —ñ —Ü—ñ–ª–æ–º—É.
      <span style="background: #7fcdbb; padding: 2px; border-radius: 4px"
        >–ó–µ–ª–µ–Ω–∏–º</span
      >
      –≤—ñ–¥—Ç—ñ–Ω–∫–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è "–°–ª—É–≥–∞ –Ω–∞—Ä–æ–¥—É",
      <span style="background: #ddd; padding: 2px; border-radius: 4px"
        >—Å—ñ—Ä–∏–º</span
      > - –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–∏–∫—ñ–≤.  –í—ñ–¥—Ç—ñ–Ω–∫–æ–º <span style="background: #fdae6b; padding: 2px; border-radius: 4px"
        >–æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ</span
      >
      - —Ç—Ä–∏ –ø–∞—Ä—Ç—ñ—ó —Ä–∞–∑–æ–º: "–ì–æ–ª–æ—Å", "–Ñ–°" —Ç–∞ "–ë–∞—Ç—å–∫—ñ–≤—â–∏–Ω—É".
      <span style="background: steelblue; padding: 2px; border-radius: 4px"
        >–°–∏–Ω—ñ–º</span
      >
      - –û–ü–ó–ñ, "–î–æ–≤—ñ—Ä—É", "–ó–∞ –º–∞–π–±—É—Ç–Ω—î", –∞ —Ç–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –≤ 2022-–º—É
      "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –£–∫—Ä–∞—ó–Ω–∏" —Ç–∞ "–ü–ª–∞—Ç—Ñ–æ—Ä–º—É –∑–∞ –∂–∏—Ç—Ç—è —ñ –º–∏—Ä" (–µ–∫—Å-–û–ü–ó–ñ)
    </div>
    <div style=" display: flex;
  align-items: center;
  justify-content: center;  ">
    <div id="chart1"></div>
      
    </div>

    –±–ª–∞-–±–ª–∞-–±–ª–∞

    <div class="multiCharts" id="multiCharts"></div>

    <script>
      d3.csv("data.csv").then(function (data_) {
        ///////////////////////data///////////////////////////////

        let frn = [
          { frn: "–í—Å—ñ —Ñ—Ä–∞–∫—Ü—ñ—ó —ñ –≥—Ä—É–ø–∏", fr: "" },
          { frn: '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–°–õ–£–ì–ê –ù–ê–†–û–î–£"', fr: "sn" },
          { frn: "–ü–æ–∑–∞—Ñ—Ä–∞–∫—Ü—ñ–π–Ω—ñ", fr: "pz" },
          {
            frn: '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–∞ —Å–æ–ª—ñ–¥–∞—Ä–Ω—ñ—Å—Ç—å"',
            fr: "es",
          },
          {
            frn: '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó –í—Å–µ—É–∫—Ä–∞—ó–Ω—Å—å–∫–µ –æ–±‚Äô—î–¥–Ω–∞–Ω–Ω—è "–ë–∞—Ç—å–∫—ñ–≤—â–∏–Ω–∞"',
            fr: "bt",
          },
          { frn: '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–ì–û–õ–û–°"', fr: "gl" },
          {
            frn: '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–û–ü–û–ó–ò–¶–Ü–ô–ù–ê –ü–õ–ê–¢–§–û–†–ú–ê-–ó–ê –ñ–ò–¢–¢–Ø"',
            fr: "op",
          },
          { frn: '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–î–û–í–Ü–†–ê"', fr: "dv" },
          { frn: '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–ü–∞—Ä—Ç—ñ—è "–ó–∞ –º–∞–π–±—É—Ç–Ω—î"', fr: "zm" },
          {
            frn: '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ –∂–∏—Ç—Ç—è —Ç–∞ –º–∏—Ä" —É –í–µ—Ä—Ö–æ–≤–Ω—ñ–π –†–∞–¥—ñ –£–∫—Ä–∞—ó–Ω–∏',
            fr: "op",
          },
          {
            frn: '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –£–∫—Ä–∞—ó–Ω–∏" —É –í–µ—Ä—Ö–æ–≤–Ω—ñ–π –†–∞–¥—ñ –£–∫—Ä–∞—ó–Ω–∏',
            fr: "zm",
          },
        ];

        data_.forEach((d) => {
          let find = frn.find((e) => e.frn == d.frn);
          d.fr = find ? find.fr : null;
        });

        let data = data_.map((d) => {
          return {
            ...d,
            law_name: d.law_name
              .replace(/.+\s–ó–∞–∫–æ–Ω—É/, "–ó–ü")
              .replace(
                /–ø—Ä–æ –≤–Ω–µ—Å–µ–Ω–Ω—è –∑–º—ñ–Ω –¥–æ –¥–µ—è–∫–∏—Ö –∑–∞–∫–æ–Ω–æ–¥–∞–≤—á–∏—Ö –∞–∫—Ç—ñ–≤ –£–∫—Ä–∞—ó–Ω–∏/,
                ""
              ),
            date: d3.timeParse("%d.%m.%Y")(d.date),
          };
        });

        // console.log(data);

        let orders = [
          '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–°–õ–£–ì–ê –ù–ê–†–û–î–£"',
          "–ü–æ–∑–∞—Ñ—Ä–∞–∫—Ü—ñ–π–Ω—ñ",
          '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–∞ —Å–æ–ª—ñ–¥–∞—Ä–Ω—ñ—Å—Ç—å"',
          '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó –í—Å–µ—É–∫—Ä–∞—ó–Ω—Å—å–∫–µ –æ–±‚Äô—î–¥–Ω–∞–Ω–Ω—è "–ë–∞—Ç—å–∫—ñ–≤—â–∏–Ω–∞"',
          '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–ì–û–õ–û–°"',
          '–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó "–û–ü–û–ó–ò–¶–Ü–ô–ù–ê –ü–õ–ê–¢–§–û–†–ú–ê-–ó–ê –ñ–ò–¢–¢–Ø"',
          '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–î–û–í–Ü–†–ê"',
          '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–ü–∞—Ä—Ç—ñ—è "–ó–∞ –º–∞–π–±—É—Ç–Ω—î"',
          '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ –∂–∏—Ç—Ç—è —Ç–∞ –º–∏—Ä" —É –í–µ—Ä—Ö–æ–≤–Ω—ñ–π –†–∞–¥—ñ –£–∫—Ä–∞—ó–Ω–∏',
          '–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ –≥—Ä—É–ø–∞ "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –£–∫—Ä–∞—ó–Ω–∏" —É –í–µ—Ä—Ö–æ–≤–Ω—ñ–π –†–∞–¥—ñ –£–∫—Ä–∞—ó–Ω–∏',
        ];

        ///////////////////////radaGolos///////////////////////////////

        function radaGolos(data, annotation, width, marginRight) {
          let screenWidth = screen.width;
          let chart = Plot.plot({
            marginLeft: 50,
            marginBottom: annotation == 1 ? 50 : 0,
            marginTop: screenWidth < 600 && annotation == 1 ? 60 : 40,
            marginRight: marginRight,
            height: width,
            width: width,
            style: {
              fontSize: screenWidth < 600 && annotation == 1 ? "18px" : "12px",
            },
            y: {
              type: "band",
              axis: null,
            },
            x: {
              domain: [0, 350],
              axis: "top",
              label: annotation == 1 ? "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ–ª–æ—Å—ñ–≤" : "",
              labelAnchor: "center",
            },
            color: {
              // legend: true,
              domain: orders,
              range: [
                "#7fcdbb",
                "#ddd",
                "#fdae6b",
                "#fdae6b",
                "#fdae6b",
                "steelblue",
                "steelblue",
                "steelblue",
                "steelblue",
                "steelblue",
              ],
            },
            marks: [
              // Plot.frame(),
              Plot.barX(
                data.filter(
                  (d) =>
                    d.total > 150 &&
                    (d.date < new Date("2021-08-01") ||
                      d.date > new Date("2021-09-01"))
                ),
                Plot.binY(
                  { x: "mean" },
                  {
                    y: (d) => d.date,
                    x: "results",
                    // curve: "basis"
                    thresholds: d3.timeMonth,
                    fill: "frn",
                    inset: annotation == 1 ? -0.7 : -0.5,
                    order: orders,
                  }
                )
              ),
              Plot.text(
                [
                  '–ü—ñ—Å–ª—è –≤–∏–±–æ—Ä—ñ–≤\n"–°–ª—É–∑—ñ –Ω–∞—Ä–æ–¥—É" –≤–∏—Å—Ç–∞—á–∞–ª–æ\n–≥–æ–ª–æ—Å—ñ–≤ (226 —ñ –±—ñ–ª—å—à–µ)\n–≤–ª–∞—Å–Ω–æ—ó –º–æ–Ω–æ–±—ñ–ª—å—à–æ—Å—Ç—ñ,\n—â–æ–± —É—Ö–≤–∞–ª—é–≤–∞—Ç–∏ –∑–∞–∫–æ–Ω–∏ ü†¢'
                ],
                {
                  x: (d) => 80,
                  textAnchor: "end",
                  frameAnchor: "top",
                  dx: 170,
                  dy: 10,
                  // y: [0.8, 0.1],
                  text: (d) => d,
                  opacity: annotation,
                  // fill: "#333",
                  // stroke: "#fff"
                }
              ),

              Plot.text(
                [
                  "–£–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ä–æ–∑–ø–∞–¥—É —É—Ä—è–¥—É,\n–≤—ñ–¥—Å—Ç–∞–≤–∫–∏ –ì–æ–Ω—á–∞—Ä—É–∫–∞ –π\n–ø–∞–Ω–¥–µ–º—ñ—ó COVID-19\n–≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏ ‚Üí"
                  
                ],
                {
                  x: (d) => 80,
                  textAnchor: "end",
                  frameAnchor: "top",
                  dx: 140,
                  dy: 135,
                  // y: [0.8, 0.1],
                  text: (d) => d,
                  opacity: annotation,
                  // fill: "#333",
                  // stroke: "#fff"
                }
              ),

              Plot.text(
                ['‚Üê –ü—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫—É\n–≤–µ–ª–∏–∫–æ—ó –≤—ñ–π–Ω–∏\n"—Å–ª—É–≥–∏" —Å—Ç–∞–ª–∏ —â–µ\n–∑–∞–ª–µ–∂–Ω—ñ—à–∏–º–∏ –≤—ñ–¥\n–¥–µ—Ä—É—Ç–∞—Ç—ñ–≤ –µ–∫—Å-–û–ü–ó–ñ\n—ñ –ø–∞—Ä—Ç—ñ–π "–±—ñ–∑–Ω–µ—Å–º–µ–Ω—ñ–≤"'
                ],
                {
                  x: (d) => 70,
                  textAnchor: "start",
                  frameAnchor: "top",
                  dx: 285,
                  dy: 405,
                  // y: [0.8, 0.1],
                  text: (d) => d,
                  opacity: annotation,
                  // fill: "#333",
                  // stroke: "#fff"
                }
              ),

              Plot.text(["2020"], {
                x: annotation == 1 ? -35 : -45,
                textAnchor: "start",
                frameAnchor: "top",
                dx: 0,
                dy: annotation == 1 ? 35 : 25,
                // y: [0.8, 0.1],
                text: (d) => d,
                // opacity: annotation,
                // stroke: "#fff"
              }),
              Plot.text(["2021"], {
                x: annotation == 1 ? -35 : -45,
                textAnchor: "start",
                frameAnchor: "top",
                dx: 0,
                dy: annotation == 1 ? 185 : 90,
                // y: [0.8, 0.1],
                text: (d) => d,
                // opacity: annotation,
                // stroke: "#fff"
              }),
              Plot.text(["2022"], {
                x: annotation == 1 ? -35 : -45,
                textAnchor: "start",
                frameAnchor: "top",
                dx: 0,
                dy: annotation == 1 ? 335 : 160,
                // y: [0.8, 0.1],
                text: (d) => d,
                // opacity: annotation,
                // stroke: "#fff"
              }),
              Plot.text(["2023"], {
                x: annotation == 1 ? -35 : -45,
                textAnchor: "start",
                frameAnchor: "top",
                dx: 0,
                dy: annotation == 1 ? 475 : 240,
                // y: [0.8, 0.1],
                text: (d) => d,
                // opacity: annotation,
                // stroke: "#fff"
              }),
              Plot.ruleX([226], { strokeWidth: 1 }),
            ],
          });
          return chart;
          // document.getElementById("chart1").appendChild(chart);
        }

        document
          .getElementById("chart1")
          .appendChild(radaGolos(data, 1, 600, 110));

        // console.log('chart',chart);
        // updateRadaGolos(data,1)

        ///////////////////////select///////////////////////////////

        //         // add the options to the button
        //         d3.select("#selectFrn")
        //           .selectAll("myOptions")
        //           .data(frn.slice(0, 9))
        //           .enter()
        //           .append("option")
        //           .text(function (d) {
        //             return d.frn;
        //           }) // text showed in the menu
        //           .attr("value", function (d) {
        //             return d.fr;
        //           });

        //         d3.select("#selectFrn").on("change", function (event, d) {
        //           // recover the option that has been chosen
        //           const selectedOption = d3.select(this).property("value");
        //           let data2 = data.filter((d) => d.fr != selectedOption);
        //           console.log(data2);
        //           d3.select("#chart svg").remove();
        //           updateRadaGolos(data2);
        //         });

        //////////////////////////multiCharts/////////////////////////////

        d3.select("#multiCharts")
          .selectAll(".multiChart")
          .data(frn.slice(2, 9))
          .enter()
          .append("div")
          .attr("id", (d, i) => "multiChart" + i)
          .attr("class", "multiChart")
          .style("display", "inline-block")
          .style("padding-top", "20px")
          .append("div")
          .style("width", "200px")
          .style("font-family", "arial")
          .style("font-size", "14px")
          .style("padding-left", "45px")
          .html(
            (d) =>
              '"–°–ª—É–≥–∏" + ' +
              d.frn
                .slice(0, 100)
                .replace(
                  /–î–µ–ø—É—Ç–∞—Ç—Å—å–∫–∞ |–§—Ä–∞–∫—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏—á–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó | —É –í–µ—Ä—Ö–æ–≤–Ω—ñ–π.+/g,
                  ""
                )
          );

        frn.slice(2, 9).map((e, i) => {
          // console.log(data)
          d3.select("multiChart" + i)
            .append("text")
            .html("tft");
          document.getElementById("multiChart" + i).appendChild(
            radaGolos(
              data.filter((d) => d.fr == 'sn' || d.fr == e.fr),
              0,
              300,
              0
            )
          );
        });
      });
    </script>
  </body>
</html>
